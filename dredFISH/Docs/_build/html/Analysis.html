
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Analysis module &#8212; dredFISH  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualization package" href="Visualization.html" />
    <link rel="prev" title="Processing package" href="Processing.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Visualization.html" title="Visualization package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Processing.html" title="Processing package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">dredFISH  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Analysis module</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="analysis-module">
<h1>Analysis module<a class="headerlink" href="#analysis-module" title="Permalink to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">¶</a></h2>
<p>The Analysis module contains two submodules: <a class="reference internal" href="#tissuegraph">TissueGraph</a> and <a class="reference internal" href="#classification">Classification</a></p>
<p><a class="reference internal" href="#tissuegraph">TissueGraph</a> module contains the data container classes that include all the core creation methods as detailed below.
<a class="reference internal" href="#classification">Classification</a> has all the code for classificaiton of cells / regions into types.</p>
</section>
<section id="analysis-tissuegraph-submodule">
<h2>Analysis.TissueGraph submodule<a class="headerlink" href="#analysis-tissuegraph-submodule" title="Permalink to this heading">¶</a></h2>
<p id="tissuegraph">Overall, TissueMultiGraph contains four interlinked data structures:</p>
<ul class="simple">
<li><p>TissueMultiGraph (TMG)</p></li>
<li><p>TissueGraph (TG)</p></li>
<li><p>Taxonomy (Tax)</p></li>
<li><p>Geoms (Geoms)</p></li>
</ul>
<p>A single dataset (multiple slices) gets a single TMG, multiple TG, multiple Tax, and multiple Geoms.
The following diagram captures the relationship between these four data structures:</p>
<a class="reference internal image-reference" href="_images/AnalysisClassDiagram.svg"><img alt="TissueGraph module class diagram" height="400" src="_images/AnalysisClassDiagram.svg" width="400" /></a>
<p><strong>TissueMultiGraph</strong>
TMG is the main object that is created for analysis of dredFISH data. The creation of TMG requires many steps and in general follows
the hierarchy of biospatial units, i.e. <a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.create_cell_layer" title="Analysis.TissueGraph.TissueMultiGraph.create_cell_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Analysis.TissueGraph.TissueMultiGraph.create_cell_layer()</span></code></a>, <a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.create_isozone_layer" title="Analysis.TissueGraph.TissueMultiGraph.create_isozone_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Analysis.TissueGraph.TissueMultiGraph.create_isozone_layer()</span></code></a>,
and <a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.create_region_layer" title="Analysis.TissueGraph.TissueMultiGraph.create_region_layer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Analysis.TissueGraph.TissueMultiGraph.create_region_layer()</span></code></a>. Taxonomies must be provided either while types are added (for cells) or
during the creation of regions. Isozones have the same taxonomy as cells so it is handeled automagically.</p>
<p>Geoms is a list of dictionaries, one for each slice, that contained geometric information about cells that comes from the basic voronoi analysis</p>
<p>The key TMG attributes are:</p>
<blockquote>
<div><ul class="simple">
<li><p>a list of TG (Layers) one for each TYPE of biospatial units (cells, isozones, regions).</p></li>
<li><p>a list of Tax (Taxonomies)</p></li>
<li><p>Mapping between TGs and Tax</p></li>
<li><p>Mapping between different Layers (cells -&gt; isozones, cells -&gt; regions)</p></li>
<li><p>a list of Geoms, one of each slices</p></li>
</ul>
</div></blockquote>
<p><strong>TissueGraph</strong>
TG is a multilayer graph G = {V,E_s,E_f} with one set of vertives V and two sets of edges E_s and E_f representing spatial and feature relationships
TG is implemented as an AnnData object (TG.adata) to allow interactin with others packages in the scverse.
However, the use of AnnData is “hidden” from TMG user and there is no need to interact with TG.adata directly.</p>
<p>TissueGraph main attributes are:</p>
<blockquote>
<div><ul class="simple">
<li><p>XY, Slice, and feature_vector for each biospatial unit (cell, isozone, regions)</p></li>
<li><p>Spatial Graph (SG) that represents physical neighborhoods</p></li>
<li><p>Feature Graph (FG) that represents feature similarities</p></li>
</ul>
</div></blockquote>
<p>TissueGraph is implemented as an AnnData object</p>
<p><strong>Taxonomy</strong>
Tax captures information about the taxonomy that is used to classify units in each TG.
Currently, Tax contains a list of types and their attributes.</p>
<p>TODO: expand on Taxonomy attributes beyond Type name and feature vector</p>
<span class="target" id="module-Analysis.TissueGraph"></span><p>TissueMultiGraph Analysis module.</p>
<p>The module contains the three main classes required graph based tissue analysis:
TissueMultiGraph: the key organizing class used to create and manage graphs across layers (hence multi)
TissueGraph: Each layers (cells, zones, regions) is defined using spatial and feature graphs that are both part ot a single tissuegraph
Taxonomy: a container class that stores information about the taxonomical units (cell types, region types).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In current implementation each TMG object is stored as multiple files in a single directory.
That is the same directory that stores all the input files used by TMG to create it’s different objects.
Only a single TMG object can exist in each directory. To create two TMG objects from the same data, just copy the raw data.</p>
</div>
<div class="admonition-example admonition">
<p class="admonition-title">Example</p>
<p>TMG is created in a folder with csv file(s) that have cells transcriptional state (*_matrix.csv) and other metadata information such as x,y, section information in (*_metadata.csv) files.
The creation of TMG follows the methods to create different layers (create_cell_layer, create_zone_layer, create_region_layer) and creating Geoms using create_geoms.</p>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.TissueGraph.</span></span><span class="sig-name descname"><span class="pre">Taxonomy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#Taxonomy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Taxonomical system for different biospatial units (cells, isozones, regions)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy.name" title="Permalink to this definition">¶</a></dt>
<dd><p>a name of the taxonomy (will be used to file io)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy.Type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Type</span></span><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy.Type" title="Permalink to this definition">¶</a></dt>
<dd><p>Building blocks of this Taxonomy</p>
<p>Setter verify that there are no duplications.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy.add_types">
<span class="sig-name descname"><span class="pre">add_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_mat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#Taxonomy.add_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy.add_types" title="Permalink to this definition">¶</a></dt>
<dd><p>add new types and their feature average to the Taxonomy</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy.feature_mat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feature_mat</span></span><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy.feature_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>feature values for all types in the taxonomy</p>
<p>Setter can get as input either numpy array (ordered same as self.Type) or pandas dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#Taxonomy.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>determie if taxonomy is empty</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#Taxonomy.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy.load" title="Permalink to this definition">¶</a></dt>
<dd><p>save from basepath using Taxonomy name</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.Taxonomy.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#Taxonomy.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.Taxonomy.save" title="Permalink to this definition">¶</a></dt>
<dd><p>save to basepath using Taxonomy name</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.TissueGraph.</span></span><span class="sig-name descname"><span class="pre">TissueGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_mat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_mat_raw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quick_load_cell_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Representation of transcriptional state of biospatial units as a graph.</p>
<p>TissueGraph (TG) is the core class used to analyze tissues using Graph representation.
TG stores a two layer graph G = {V,Es,Ef} where Es are spatial edges (physical neighbors) and Ef are feature neighnors.
TG stores information on position (XYS) and features that used to created these graphs using anndata object representation.
Each TG has a reference to a Taxonomy object that contains information on the types (</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>TissueGraph objects are typically not created on their own, but using method calls of TMG (create_{cell,isozones,regions}_layer)</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.tax">
<span class="sig-name descname"><span class="pre">tax</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.tax" title="Permalink to this definition">¶</a></dt>
<dd><p>a Taxonomy object that contain labels, type stats, and relationship between types.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy" title="Analysis.TissueGraph.Taxonomy">Taxonomy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.SG">
<span class="sig-name descname"><span class="pre">SG</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.SG" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph representation of the spatial relationship between biospatiual units (i.e. cells, zones, regions).
SG might include multiple componennts for multiple slice data and is non-weighted graph (1 - neighbors, 0 not neighbors).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>iGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.FG">
<span class="sig-name descname"><span class="pre">FG</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.FG" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph representation of feature similarity between biospatial units.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>iGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="simple">
<dt>main methods:</dt><dd><ul class="simple">
<li><p>contract_graph - find zones/region, i.e. spatially continous areas in the graph the same (cell/microenvironment) type</p></li>
<li><p>cond_entopy - calculates the conditional entropy of a graph given types (or uses defaults existing types)</p></li>
<li><p>watershed - devide into regions based on watershed</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.N">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">N</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.N" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of the tissue graph
internally stored as igraph size</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.Nslices">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Nslices</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.Nslices" title="Permalink to this definition">¶</a></dt>
<dd><p>returns number of unique slices in TG</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Nslices</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.Ntypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Ntypes</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.Ntypes" title="Permalink to this definition">¶</a></dt>
<dd><p>returns number of unique types in the graph</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Ntypes</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.Slice">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Slice</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.Slice" title="Permalink to this definition">¶</a></dt>
<dd><p>dependent property - will query info from anndata and return</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Slice</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.Type">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Type</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.Type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.Upstream">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Upstream</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.Upstream" title="Permalink to this definition">¶</a></dt>
<dd><p>mapping between current TG layer (self) and upstream layer
Return value has the length of upstream level and index values of current layer</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.X">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">X</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.X" title="Permalink to this definition">¶</a></dt>
<dd><p>dependent property - will query info from Graph and return</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>X</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.XY">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">XY</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.XY" title="Permalink to this definition">¶</a></dt>
<dd><p>dependent property - will query info from anndata and return</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>XY</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.Y">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Y</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.Y" title="Permalink to this definition">¶</a></dt>
<dd><p>dependent property - will query info from Graph and return</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Y</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.build_feature_graph">
<span class="sig-name descname"><span class="pre">build_feature_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accuracy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'extras':</span> <span class="pre">1.5,</span> <span class="pre">'prob':</span> <span class="pre">1}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_kwds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.build_feature_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.build_feature_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>construct k-graph based on feature similarity</p>
<p>Create a kNN graph (an igraph object) based on feature similarity. The core of this method is the calculation on how to find neighbors.
If metric is “precomputed” the distances are assumed to be known and we’re almost done.
For all other metric values, we use pynndescent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>numpy array</em>) – Either a distance matrix, i.e. squareform(pdist(feature_mat)) if metric = ‘precomputed’.  ) or just a feature_mat</p></li>
<li><p><strong>n_neighbors</strong> (<em>int</em>) – How many neighbors (k) should we use in the knn graph</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – either “precomputed”, “random”, or one of the MANY metrics supported by pynndescent. Random is for debugging only.</p></li>
<li><p><strong>accuracy</strong> (<em>dict with fields: 'prob' and 'extras'</em>) – a dictionary with accuracy options for pynndescent. ‘prob’ should be in [0,1] and ‘extras’ is typically &gt;1.
accuracy[‘prob’] conrols the ‘diversify_prob’ and accuracy[‘extra’] the ‘pruning_degree_multplier’</p></li>
<li><p><strong>metric_kwds</strong> (<em>dict</em>) – passthrough kwds that will be sent to pynndescent.</p></li>
<li><p><strong>return_graph</strong> (<em>bool</em>) – will return the graph instead of updating self.FG</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are LOTS of metric implemnted in pynndescent.
Many are not updated in the readthedocs so check the sources code!</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.build_spatial_graph">
<span class="sig-name descname"><span class="pre">build_spatial_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">XYS</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.build_spatial_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.build_spatial_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>construct graph based on Delaunay neighbors</p>
<p>build_spatial_graph will create an igrah using Delaunay triangulation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>XYS</strong> (<em>numpy Nx2</em><em> or </em><em>Nx3 array</em>) – </p></li>
<li><p><strong>around</strong> (<em>centroid regions to build a graph</em>) – if it’s only Nx2 assuming a single S=0</p></li>
<li><p><strong>X</strong> (<em>data is assumed to be Nx3 with</em>) – if it’s only Nx2 assuming a single S=0</p></li>
<li><p><strong>data</strong> (<em>Y and S</em><em> (</em><em>slice</em><em>)</em>) – if it’s only Nx2 assuming a single S=0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.calc_entropy_at_different_Leiden_resolutions">
<span class="sig-name descname"><span class="pre">calc_entropy_at_different_Leiden_resolutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Rvec=&lt;Mock</span> <span class="pre">name='mock.logspace()'</span> <span class="pre">id='140651168261744'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.calc_entropy_at_different_Leiden_resolutions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.calc_entropy_at_different_Leiden_resolutions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.cond_entropy">
<span class="sig-name descname"><span class="pre">cond_entropy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.cond_entropy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.cond_entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>calculate conditional entropy of the tissue graph</p>
<p>cond entropy is the difference between graph entropy based on zones and type entropy</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.contract_graph">
<span class="sig-name descname"><span class="pre">contract_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TypeVec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.contract_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.contract_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>find zones/region, i.e. spatially continous areas in the graph the same (cell/microenvironment) type</p>
<p>reduce graph size by merging spatial neighbors of same type.
Given a vector of types, will contract the graph to merge vertices that are both next to each other and of the same type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>TypeVec</strong> (<em>1D numpy array with dtype int</em><em> (</em><em>default value is self.Type</em><em>)</em>) – a vector of Types for each node. If None, will use self.Type</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Default behavior is to assign the contracted TG the same taxonomy as the original graph.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A TG object after vertices merging.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph" title="Analysis.TissueGraph.TissueGraph">TissueGraph</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.extract_environments">
<span class="sig-name descname"><span class="pre">extract_environments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ordr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">typevec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.extract_environments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.extract_environments" title="Permalink to this definition">¶</a></dt>
<dd><p>returns the categorical distribution of neighbors.</p>
<dl class="simple">
<dt>Depending on input there could be two uses,</dt><dd><p>usage 1: if ordr is not None returns local neighberhood defined as nodes up to distance ordr on the graph for all vertices.
usage 2: if typevec is not None returns local env based on typevec, will return one env for each unique type in typevec</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Array with Type frequency for all local environments for all types in TG.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.feature_mat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">feature_mat</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.feature_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>the feature values for this TG observations</p>
<p>The feature_mat is stored in the underlying anndata object and is required to properly init it.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.gradient_magnitude">
<span class="sig-name descname"><span class="pre">gradient_magnitude</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.gradient_magnitude"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial gradient based on spatial graph</p>
<p>Calculate the gradient defined as sqrt(dV/dx^2+dV/dy^2) where dV/dx(y) is calcualted using simple trigo</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.graph_local_avg">
<span class="sig-name descname"><span class="pre">graph_local_avg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">VecToSmooth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordr=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel=&lt;Mock</span> <span class="pre">name='mock.array()'</span> <span class="pre">id='140651168226560'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.graph_local_avg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.graph_local_avg" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple local average of a Vec based on local neighborgood</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>VecToSmooth</strong> (<em>numpy array</em>) – The values we want to smooth. len(VecToSmooth) must be self.N</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.graph_local_median">
<span class="sig-name descname"><span class="pre">graph_local_median</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">VecToSmooth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.graph_local_median"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.graph_local_median" title="Permalink to this definition">¶</a></dt>
<dd><p>local median of VecToSmooth based in spatial graph</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.is_empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the TG object is empty</p>
<p>Checks if internal adata is None of empty</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">names</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.names" title="Permalink to this definition">¶</a></dt>
<dd><p>observation names</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.node_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">node_size</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.node_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.save" title="Permalink to this definition">¶</a></dt>
<dd><p>save TG to file</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.type_freq">
<span class="sig-name descname"><span class="pre">type_freq</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.type_freq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.type_freq" title="Permalink to this definition">¶</a></dt>
<dd><p>return the catogorical probability for each type in TG</p>
<p>Probabilities are weighted by the node_size</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueGraph.watershed">
<span class="sig-name descname"><span class="pre">watershed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">InputVec</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueGraph.watershed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueGraph.watershed" title="Permalink to this definition">¶</a></dt>
<dd><p>Watershed segmentation based on InputVec values</p>
<p>Watershed on the TG spatial graph.
First finds local peaks and then assigns all nodes to their closest local peak using dijkstra</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple with id and distance to cloest zone.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>(id,dist)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.TissueGraph.</span></span><span class="sig-name descname"><span class="pre">TissueMultiGraph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">basepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quick_load_cell_obs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Main class used to manage the creation of multi-layer graph representation of tissues.</p>
<p>TissueMultiGraph (TMG) acts as a factory to create objects that represents the state of different biospatial units in tissue,
and their relationships. Examples of biospatial units are cells, isozones, regions.
The main objects that TMG creates and stores are TissueGraphs, Taxonomies, and Geoms.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.Layers">
<span class="sig-name descname"><span class="pre">Layers</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.Layers" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the main spatial/feature data storage representing biospatial units (cells, isozones, and regions)</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.Taxonomies">
<span class="sig-name descname"><span class="pre">Taxonomies</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.Taxonomies" title="Permalink to this definition">¶</a></dt>
<dd><p>The taxonomical representation of the different types biospatial units can have.
There is a many-to-one relationship between TissueGraphs Layers and Taxonomies.
Multiple layers can have the same taxnomy (cells and isozones both have the same taxonomy).
The Taxonomies store type related information (full names, feature_type_mats, relationship between types, etc).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.Geoms">
<span class="sig-name descname"><span class="pre">Geoms</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.Geoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Geometrical aspects of the TMG required for Vizualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.basepath">
<span class="sig-name descname"><span class="pre">basepath</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.basepath" title="Permalink to this definition">¶</a></dt>
<dd><p>The base path with all TMG related files.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.layers_graph">
<span class="sig-name descname"><span class="pre">layers_graph</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.layers_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores relatioship between layers.
For example, [(1,2),(1,3)] inducates that layer 2 used layer 1 (isozones are build on cells) and that layer 3 (regions) uses layer 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.layer_taxonomy_mapping">
<span class="sig-name descname"><span class="pre">layer_taxonomy_mapping</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.layer_taxonomy_mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores relationship between TG layers and Taxonomies</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.N">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">N</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.N" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of cells in each layer of TMG.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.Ntypes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Ntypes</span></span><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.Ntypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of types in each layer of TMG.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.add_geoms">
<span class="sig-name descname"><span class="pre">add_geoms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.add_geoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.add_geoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the geometries needed (boundingbox, lines, points, and polygons) to be used in views to create maps.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.add_type_information">
<span class="sig-name descname"><span class="pre">add_type_information</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.add_type_information"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.add_type_information" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds type information to TMG</p>
<p>Bookeeping method to add type information and update taxonomies etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_id</strong> (<em>int</em>) – what layers are we adding type info to? should be a <cite>cell</cite> layer</p></li>
<li><p><strong>type_vec</strong> (<em>numpy 1D array / list</em>) – the integer codes of type</p></li>
<li><p><strong>tax</strong> (<em>int / Taxonomy</em>) – either an integer that will be intepreted as an index to existing taxonomies or a Taxonomy object</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.create_cell_layer">
<span class="sig-name descname"><span class="pre">create_cell_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.create_cell_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.create_cell_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creating cell layer from raw data.
TODO: Fix documentaion after finishing Taxonomy class.</p>
<p>Cell layer is unique as it’s the only one where spatial information is directly used with Voronoi</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>slices</strong><strong>)</strong> (<em>path_to_raw_data - path to folder with all raw-data</em><em> (</em><em>multiple</em>) – </p></li>
<li><p><strong>cells.</strong> (<em>celltypes_org - labels for</em>) – </p></li>
<li><p><strong>values</strong> (<em>expand_types - id</em><em> of </em><em>cell types to expand. If they are all the last</em>) – </p></li>
<li><p><strong>continous</strong> (<em>numbering will be</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.create_isozone_layer">
<span class="sig-name descname"><span class="pre">create_isozone_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.create_isozone_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.create_isozone_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates isozones layer using cell types.
= IsoZoneLayer.tax
Contract cell types to create isozone graph.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.create_region_layer">
<span class="sig-name descname"><span class="pre">create_region_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">region_tax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.create_region_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.create_region_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Add region layor given cells’ region types (topics)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>topics</strong> (<em>numpy array / list</em>) – An array with local type environment (a number for each cell)</p></li>
<li><p><strong>region_tax</strong> (<a class="reference internal" href="#Analysis.TissueGraph.Taxonomy" title="Analysis.TissueGraph.Taxonomy"><em>Taxonomy</em></a>) – A Taxonomy object that contains the region classification scheme</p></li>
<li><p><strong>cell_layer</strong> (<em>int</em><em> (</em><em>default</em><em>,</em><em>0</em><em>)</em>) – Which layer in TMG is the cell layer?</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.fill_holes">
<span class="sig-name descname"><span class="pre">fill_holes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lvl_to_fill</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_node_size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.fill_holes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.fill_holes" title="Permalink to this definition">¶</a></dt>
<dd><p>EXPERIMENTAL: merges small biospatial units with their neighbors.</p>
<p>The goal of this method is to allow filling up “holes”, i.e. chunks in the tissue graph that we
are unhappy about their type using local neighbor types.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As of 6/8/2022 this method is not ready for production use.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.find_regions_edge_level">
<span class="sig-name descname"><span class="pre">find_regions_edge_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region_layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.find_regions_edge_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.find_regions_edge_level" title="Permalink to this definition">¶</a></dt>
<dd><p>finds cells graph edges that are also region edges</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.find_upstream_layer">
<span class="sig-name descname"><span class="pre">find_upstream_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.find_upstream_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.find_upstream_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>#TODO: remove hardcoded cell is always “root”
(Fangming: why not fixing a root layer (layer 0) that is always <cite>cells</cite>)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.map_to_cell_level">
<span class="sig-name descname"><span class="pre">map_to_cell_level</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lvl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VecToMap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_ix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.map_to_cell_level"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.map_to_cell_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps values to first layer of the graph, mostly used for plotting.
lvl is the level we want to map all the way to</p>
<p>TODO: this function might have some problems</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.TissueGraph.TissueMultiGraph.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/TissueGraph.html#TissueMultiGraph.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.TissueGraph.TissueMultiGraph.save" title="Permalink to this definition">¶</a></dt>
<dd><p>create the TMG.json and save everything.</p>
<p>Saving scheme:
TissueGraphs in Layers and Taxonomies in Taxonomies are stored in a single anndata file per object according to theor own .save() method
Geoms are currently not saved and are recreated on load
mapping between layers and the names of different objects in layers (to be loaded and saved) are saved in a simple TMG.json file.</p>
</dd></dl>

</dd></dl>

</section>
<section id="analysis-classification-submodule">
<h2>Analysis.Classification submodule<a class="headerlink" href="#analysis-classification-submodule" title="Permalink to this heading">¶</a></h2>
<p id="classification">The goal of the classes in this module is to provide classification services to data in TMG. Any statistical classification applied
to any biospatial units must use the Classifier hierarchy. At the top of the hierarchy is an abstract class that defines the interface
for classificaiton. The interface has two methods: <a class="reference internal" href="#Analysis.Classification.KNNClassifier.train" title="Analysis.Classification.KNNClassifier.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Analysis.Classification.KNNClassifier.train()</span></code></a> and <a class="reference internal" href="#Analysis.Classification.KNNClassifier.train" title="Analysis.Classification.KNNClassifier.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Analysis.Classification.KNNClassifier.train()</span></code></a></p>
<p>Any subclass can add any addional field required, but the heavy lifting should be done in train/classify.</p>
<p>In cases that the underlying classificaiton is unsupervized, the classifier will also generated a taxonomy</p>
<p>the current class diagram is the following:</p>
<a class="reference internal image-reference" href="_images/ClassifierClassDiagram.svg"><img alt="Classification module class diagram" height="400" src="_images/ClassifierClassDiagram.svg" width="400" /></a>
<span class="target" id="module-Analysis.Classification"></span><p>Classification of biospatial units in TMG analysis</p>
<p>This module contains the main classes related to the task of classification of biospatial units (i.e. cells, isozones, regions) into type.
The module is composed of a class hierarchy of classifiers. The “root” of this heirarchy is an abstract base class “Classifier” that has two
abstract methods (train and classify) that any subclass will have to implement.</p>
<dl class="py class">
<dt class="sig sig-object py" id="Analysis.Classification.Classifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.Classification.</span></span><span class="sig-name descname"><span class="pre">Classifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#Classifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.Classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Interface for classifiers</p>
<p>This is an abstract class that defines the interface (i.e. methods and attributes) that all different classifiers must have.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.Classification.Classifier.tax">
<span class="sig-name descname"><span class="pre">tax</span></span><a class="headerlink" href="#Analysis.Classification.Classifier.tax" title="Permalink to this definition">¶</a></dt>
<dd><p>A taxonomy system that the classifier classifies into.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy" title="Analysis.TissueGraph.Taxonomy">Taxonomy</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.Classifier.classify">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#Classifier.classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.Classifier.classify" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifies input into types</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.Classifier.train">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#Classifier.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.Classifier.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a classifier</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Analysis.Classification.KNNClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.Classification.</span></span><span class="sig-name descname"><span class="pre">KNNClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">approx_nn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'correlation'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#KNNClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.KNNClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#Analysis.Classification.Classifier" title="Analysis.Classification.Classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Classifier</span></code></a></p>
<p>k-nearest-neighbor classifier</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.Classification.KNNClassifier.k">
<span class="sig-name descname"><span class="pre">k</span></span><a class="headerlink" href="#Analysis.Classification.KNNClassifier.k" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of local neighbors to consider</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int (default = 1)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.Classification.KNNClassifier.approx_nn">
<span class="sig-name descname"><span class="pre">approx_nn</span></span><a class="headerlink" href="#Analysis.Classification.KNNClassifier.approx_nn" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of NN used by pynndescent to construct the approximate knn graph</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int (default = 30)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="Analysis.Classification.KNNClassifier.metric">
<span class="sig-name descname"><span class="pre">metric</span></span><a class="headerlink" href="#Analysis.Classification.KNNClassifier.metric" title="Permalink to this definition">¶</a></dt>
<dd><p>What metric to use to determine similarity</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str (default = ‘correlation’)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.KNNClassifier.classify">
<span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#KNNClassifier.classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.KNNClassifier.classify" title="Permalink to this definition">¶</a></dt>
<dd><p>Find class of rows in data based on approx. KNN</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.KNNClassifier.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ref_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_label_id</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#KNNClassifier.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.KNNClassifier.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds approx. KNN graph for queries</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Analysis.Classification.KnownCellTypeClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.Classification.</span></span><span class="sig-name descname"><span class="pre">KnownCellTypeClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tax_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'known_celltypes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'allen_smrt_dpnmf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_levels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['class_label',</span> <span class="pre">'neighborhood_label',</span> <span class="pre">'subclass_label',</span> <span class="pre">'cluster_label']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'knn'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#KnownCellTypeClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.KnownCellTypeClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#Analysis.Classification.Classifier" title="Analysis.Classification.Classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Classifier</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.KnownCellTypeClassifier.classify">
<span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#KnownCellTypeClassifier.classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.KnownCellTypeClassifier.classify" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifies input into types</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.KnownCellTypeClassifier.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">run_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'run'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_kwargs_perlevel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[{'norm':</span> <span class="pre">'per_bit_equalscale',</span> <span class="pre">'ranknorm':</span> <span class="pre">False,</span> <span class="pre">'n_cells':</span> <span class="pre">100}]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_internal_failure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#KnownCellTypeClassifier.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.KnownCellTypeClassifier.train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Analysis.Classification.OptimalLeidenKNNClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.Classification.</span></span><span class="sig-name descname"><span class="pre">OptimalLeidenKNNClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TG</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#OptimalLeidenKNNClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.OptimalLeidenKNNClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#Analysis.Classification.KNNClassifier" title="Analysis.Classification.KNNClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">KNNClassifier</span></code></a></p>
<p>Classifiy cells based on unsupervized Leiden</p>
<p>This classifiers is trained using unsupervized learning with later classification done by knn (k=1)
the implementations uses the same classify method as KNNClassifier.
The overladed train method does the unsupervized learning before calling super().train to create the KNN index.</p>
<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.OptimalLeidenKNNClassifier.classify">
<span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#OptimalLeidenKNNClassifier.classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.OptimalLeidenKNNClassifier.classify" title="Permalink to this definition">¶</a></dt>
<dd><p>Find class of rows in data based on approx. KNN</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.OptimalLeidenKNNClassifier.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opt_res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'iters':</span> <span class="pre">10,</span> <span class="pre">'n_consensus':</span> <span class="pre">50}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#OptimalLeidenKNNClassifier.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.OptimalLeidenKNNClassifier.train" title="Permalink to this definition">¶</a></dt>
<dd><p>training for this class is performing optimal leiden clustering</p>
<p>Optimization is done over resolution parameter trying to maximize the TG conditional entropy.
The analysis uses the two graphs (spatial and features) and finds a resolution parameters that will maximize
the conditional entropy, H(Zone|Type).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>opt_params</strong> (<em>dict</em>) – Few parameters that control optimizaiton.
‘iter’ is the number of repeats in each optimization round.
‘n_consensus’ is the number of times to do the final clustering with optimal resolution.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="Analysis.Classification.TopicClassifier">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Analysis.Classification.</span></span><span class="sig-name descname"><span class="pre">TopicClassifier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#TopicClassifier"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.TopicClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#Analysis.Classification.Classifier" title="Analysis.Classification.Classifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">Classifier</span></code></a></p>
<p>Uses Latent Dirichlet Allocation to classify cells into regions types.</p>
<p>Decision on number of topics comes from maximizing overall entropy.</p>
<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.TopicClassifier.classify">
<span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#TopicClassifier.classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.TopicClassifier.classify" title="Permalink to this definition">¶</a></dt>
<dd><p>classify based on fitted LDA</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.TopicClassifier.lda_fit">
<span class="sig-name descname"><span class="pre">lda_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_topics</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#TopicClassifier.lda_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.TopicClassifier.lda_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>This cannot be nested inside</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Analysis.Classification.TopicClassifier.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_topics_list=&lt;Mock</span> <span class="pre">name='mock.geomspace().astype()'</span> <span class="pre">id='140651165535440'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_procs=1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Analysis/Classification.html#TopicClassifier.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Analysis.Classification.TopicClassifier.train" title="Permalink to this definition">¶</a></dt>
<dd><p>fit multiple LDA models and chose the one with highest type entropy</p>
</dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Analysis module</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#analysis-tissuegraph-submodule">Analysis.TissueGraph submodule</a><ul>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy"><code class="docutils literal notranslate"><span class="pre">Taxonomy</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy.name"><code class="docutils literal notranslate"><span class="pre">Taxonomy.name</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy.Type"><code class="docutils literal notranslate"><span class="pre">Taxonomy.Type</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy.add_types"><code class="docutils literal notranslate"><span class="pre">Taxonomy.add_types()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy.feature_mat"><code class="docutils literal notranslate"><span class="pre">Taxonomy.feature_mat</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy.is_empty"><code class="docutils literal notranslate"><span class="pre">Taxonomy.is_empty()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy.load"><code class="docutils literal notranslate"><span class="pre">Taxonomy.load()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.Taxonomy.save"><code class="docutils literal notranslate"><span class="pre">Taxonomy.save()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph"><code class="docutils literal notranslate"><span class="pre">TissueGraph</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.tax"><code class="docutils literal notranslate"><span class="pre">TissueGraph.tax</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.SG"><code class="docutils literal notranslate"><span class="pre">TissueGraph.SG</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.FG"><code class="docutils literal notranslate"><span class="pre">TissueGraph.FG</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.N"><code class="docutils literal notranslate"><span class="pre">TissueGraph.N</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.Nslices"><code class="docutils literal notranslate"><span class="pre">TissueGraph.Nslices</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.Ntypes"><code class="docutils literal notranslate"><span class="pre">TissueGraph.Ntypes</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.Slice"><code class="docutils literal notranslate"><span class="pre">TissueGraph.Slice</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.Type"><code class="docutils literal notranslate"><span class="pre">TissueGraph.Type</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.Upstream"><code class="docutils literal notranslate"><span class="pre">TissueGraph.Upstream</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.X"><code class="docutils literal notranslate"><span class="pre">TissueGraph.X</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.XY"><code class="docutils literal notranslate"><span class="pre">TissueGraph.XY</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.Y"><code class="docutils literal notranslate"><span class="pre">TissueGraph.Y</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.build_feature_graph"><code class="docutils literal notranslate"><span class="pre">TissueGraph.build_feature_graph()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.build_spatial_graph"><code class="docutils literal notranslate"><span class="pre">TissueGraph.build_spatial_graph()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.calc_entropy_at_different_Leiden_resolutions"><code class="docutils literal notranslate"><span class="pre">TissueGraph.calc_entropy_at_different_Leiden_resolutions()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.cond_entropy"><code class="docutils literal notranslate"><span class="pre">TissueGraph.cond_entropy()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.contract_graph"><code class="docutils literal notranslate"><span class="pre">TissueGraph.contract_graph()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.extract_environments"><code class="docutils literal notranslate"><span class="pre">TissueGraph.extract_environments()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.feature_mat"><code class="docutils literal notranslate"><span class="pre">TissueGraph.feature_mat</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.gradient_magnitude"><code class="docutils literal notranslate"><span class="pre">TissueGraph.gradient_magnitude()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.graph_local_avg"><code class="docutils literal notranslate"><span class="pre">TissueGraph.graph_local_avg()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.graph_local_median"><code class="docutils literal notranslate"><span class="pre">TissueGraph.graph_local_median()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.is_empty"><code class="docutils literal notranslate"><span class="pre">TissueGraph.is_empty()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.names"><code class="docutils literal notranslate"><span class="pre">TissueGraph.names</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.node_size"><code class="docutils literal notranslate"><span class="pre">TissueGraph.node_size</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.save"><code class="docutils literal notranslate"><span class="pre">TissueGraph.save()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.type_freq"><code class="docutils literal notranslate"><span class="pre">TissueGraph.type_freq()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueGraph.watershed"><code class="docutils literal notranslate"><span class="pre">TissueGraph.watershed()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.Layers"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.Layers</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.Taxonomies"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.Taxonomies</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.Geoms"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.Geoms</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.basepath"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.basepath</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.layers_graph"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.layers_graph</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.layer_taxonomy_mapping"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.layer_taxonomy_mapping</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.N"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.N</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.Ntypes"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.Ntypes</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.add_geoms"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.add_geoms()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.add_type_information"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.add_type_information()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.create_cell_layer"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.create_cell_layer()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.create_isozone_layer"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.create_isozone_layer()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.create_region_layer"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.create_region_layer()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.fill_holes"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.fill_holes()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.find_regions_edge_level"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.find_regions_edge_level()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.find_upstream_layer"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.find_upstream_layer()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.map_to_cell_level"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.map_to_cell_level()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.TissueGraph.TissueMultiGraph.save"><code class="docutils literal notranslate"><span class="pre">TissueMultiGraph.save()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#analysis-classification-submodule">Analysis.Classification submodule</a><ul>
<li><a class="reference internal" href="#Analysis.Classification.Classifier"><code class="docutils literal notranslate"><span class="pre">Classifier</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.Classification.Classifier.tax"><code class="docutils literal notranslate"><span class="pre">Classifier.tax</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.Classifier.classify"><code class="docutils literal notranslate"><span class="pre">Classifier.classify()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.Classifier.train"><code class="docutils literal notranslate"><span class="pre">Classifier.train()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Analysis.Classification.KNNClassifier"><code class="docutils literal notranslate"><span class="pre">KNNClassifier</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.Classification.KNNClassifier.k"><code class="docutils literal notranslate"><span class="pre">KNNClassifier.k</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.KNNClassifier.approx_nn"><code class="docutils literal notranslate"><span class="pre">KNNClassifier.approx_nn</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.KNNClassifier.metric"><code class="docutils literal notranslate"><span class="pre">KNNClassifier.metric</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.KNNClassifier.classify"><code class="docutils literal notranslate"><span class="pre">KNNClassifier.classify()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.KNNClassifier.train"><code class="docutils literal notranslate"><span class="pre">KNNClassifier.train()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Analysis.Classification.KnownCellTypeClassifier"><code class="docutils literal notranslate"><span class="pre">KnownCellTypeClassifier</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.Classification.KnownCellTypeClassifier.classify"><code class="docutils literal notranslate"><span class="pre">KnownCellTypeClassifier.classify()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.KnownCellTypeClassifier.train"><code class="docutils literal notranslate"><span class="pre">KnownCellTypeClassifier.train()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Analysis.Classification.OptimalLeidenKNNClassifier"><code class="docutils literal notranslate"><span class="pre">OptimalLeidenKNNClassifier</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.Classification.OptimalLeidenKNNClassifier.classify"><code class="docutils literal notranslate"><span class="pre">OptimalLeidenKNNClassifier.classify()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.OptimalLeidenKNNClassifier.train"><code class="docutils literal notranslate"><span class="pre">OptimalLeidenKNNClassifier.train()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#Analysis.Classification.TopicClassifier"><code class="docutils literal notranslate"><span class="pre">TopicClassifier</span></code></a><ul>
<li><a class="reference internal" href="#Analysis.Classification.TopicClassifier.classify"><code class="docutils literal notranslate"><span class="pre">TopicClassifier.classify()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.TopicClassifier.lda_fit"><code class="docutils literal notranslate"><span class="pre">TopicClassifier.lda_fit()</span></code></a></li>
<li><a class="reference internal" href="#Analysis.Classification.TopicClassifier.train"><code class="docutils literal notranslate"><span class="pre">TopicClassifier.train()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="Processing.html"
                          title="previous chapter">Processing package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="Visualization.html"
                          title="next chapter">Visualization package</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Analysis.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="Visualization.html" title="Visualization package"
             >next</a> |</li>
        <li class="right" >
          <a href="Processing.html" title="Processing package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">dredFISH  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Analysis module</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2022, Wollman lab.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.0.0.
    </div>
  </body>
</html>