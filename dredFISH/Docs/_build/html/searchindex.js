Search.setIndex({"docnames": ["Analysis", "Design", "Processing", "Utils", "Visualization", "index"], "filenames": ["Analysis.rst", "Design.rst", "Processing.rst", "Utils.rst", "Visualization.rst", "index.rst"], "titles": ["Analysis", "Design", "Processing", "Utils", "Visualization", "Welcome to dredFISH\u2019s documentation!"], "terms": {"The": [0, 4], "modul": [0, 1, 4, 5], "contain": [0, 4], "two": [0, 1, 4], "submodul": 0, "data": [0, 1, 2, 3, 4], "class": [0, 1, 2, 3, 4], "includ": [0, 4], "all": [0, 3, 4], "core": 0, "creation": 0, "method": [0, 4], "detail": 0, "below": [0, 1], "ha": [0, 4], "code": [0, 4], "classificaiton": 0, "cell": [0, 1, 2, 3, 4], "region": [0, 4], "type": [0, 1, 2, 4], "overal": [0, 3], "tissuemultigraph": [0, 4, 5], "four": 0, "interlink": 0, "structur": [0, 3], "tmg": [0, 4], "tg": 0, "taxonomi": [0, 5], "tax": 0, "geom": 0, "A": [0, 4], "singl": 0, "dataset": [0, 1], "multipl": 0, "slice": 0, "get": [0, 1, 3, 4], "follow": 0, "diagram": 0, "captur": 0, "relationship": 0, "between": 0, "i": [0, 3, 4], "main": [0, 2], "object": [0, 1, 2, 3, 4], "creat": [0, 3, 4], "dredfish": [0, 1], "requir": [0, 4], "mani": [0, 1], "step": 0, "gener": [0, 2], "hierarchi": [0, 4], "biospati": 0, "unit": [0, 4], "e": 0, "create_cell_lay": 0, "create_isozone_lay": 0, "create_region_lay": 0, "must": 0, "provid": [0, 4], "either": [0, 4], "while": [0, 1, 3], "ar": [0, 1, 2, 3, 4], "ad": [0, 1], "dure": [0, 4], "isozon": [0, 4, 5], "have": [0, 4], "same": [0, 3], "so": [0, 1], "handel": 0, "automag": 0, "list": 0, "dictionari": [0, 3], "one": [0, 1], "each": [0, 3, 4], "geometr": 0, "inform": [0, 4], "about": 0, "come": 0, "from": [0, 1, 3, 4], "basic": [0, 1], "voronoi": 0, "kei": [0, 4], "attribut": 0, "layer": [0, 1], "map": [0, 3, 4, 5], "differ": [0, 3, 4], "multilay": 0, "graph": [0, 3], "g": [0, 3], "v": [0, 3, 4], "e_": 0, "e_f": 0, "set": [0, 1, 3], "vertiv": 0, "edg": 0, "repres": [0, 3], "spatial": [0, 4], "featur": [0, 1, 3], "implement": [0, 4], "an": [0, 3, 4], "anndata": 0, "adata": 0, "allow": [0, 3, 4], "interactin": 0, "other": [0, 4], "packag": 0, "scvers": 0, "howev": 0, "us": [0, 3, 4], "hidden": 0, "user": [0, 2, 4], "need": [0, 4], "interact": 0, "directli": 0, "xy": 0, "feature_vector": 0, "sg": 0, "physic": 0, "neighborhood": [0, 4], "fg": 0, "similar": 0, "classifi": [0, 3, 5], "current": 0, "todo": 0, "expand": [0, 3], "beyond": 0, "name": [0, 1, 2, 4], "vector": [0, 3, 4], "three": 0, "base": [0, 1, 2, 3, 4], "tissu": 0, "organ": 0, "manag": [0, 4], "across": [0, 1, 3], "henc": 0, "multi": 0, "zone": [0, 4], "defin": [0, 3, 4], "both": [0, 1], "part": 0, "ot": 0, "store": 0, "taxonom": 0, "In": [0, 1], "file": 0, "directori": [0, 1], "That": 0, "input": [0, 1, 4], "": [0, 4], "onli": [0, 1, 3, 4], "can": [0, 3], "exist": 0, "To": 0, "just": 0, "copi": [0, 3], "raw": [0, 3], "folder": 0, "csv": 0, "transcript": 0, "state": 0, "_matrix": 0, "metadata": [0, 2], "x": [0, 1, 3], "y": [0, 3], "section": [0, 4, 5], "_metadata": 0, "create_zone_lay": 0, "create_geom": 0, "none": [0, 1, 3, 4], "sourc": [0, 1, 2, 3, 4], "system": 0, "io": 0, "str": [0, 2], "properti": [0, 4], "build": 0, "block": 0, "thi": [0, 3, 4], "setter": 0, "verifi": 0, "duplic": 0, "add_typ": 0, "new_typ": 0, "feature_mat": 0, "add": [0, 4], "new": [0, 3], "averag": [0, 3], "valu": [0, 1, 3, 4], "numpi": [0, 2, 3, 4], "arrai": [0, 2, 3, 4], "order": [0, 3], "self": [0, 1, 4], "panda": 0, "datafram": [0, 4], "ndarrai": 0, "is_empti": 0, "determi": 0, "empti": [0, 3], "load": [0, 1, 2, 4], "basepath": 0, "save": [0, 1, 3, 4], "feature_mat_raw": 0, "layer_typ": 0, "redo": 0, "fals": [0, 1, 2, 3], "ob": 0, "quick_load_cell_ob": 0, "represent": 0, "analyz": 0, "ef": 0, "where": [0, 1, 4], "neighbor": 0, "neighnor": 0, "posit": 0, "refer": [0, 3], "typic": 0, "own": 0, "call": [0, 2, 4], "create_": 0, "_layer": 0, "label": [0, 1, 3], "stat": 0, "biospatiu": 0, "might": 0, "componennt": 0, "non": [0, 1], "weight": [0, 1], "1": [0, 1, 2, 3, 4], "0": [0, 1, 2, 3, 4], "igraph": 0, "contract_graph": 0, "find": [0, 1], "contin": 0, "area": 0, "microenviron": 0, "cond_entopi": 0, "calcul": [0, 4], "condit": 0, "entropi": 0, "given": [0, 3, 4], "default": [0, 1, 2], "watersh": 0, "devid": 0, "n": [0, 1, 2, 3], "size": [0, 3, 4], "intern": 0, "int": [0, 1, 2, 3], "nslice": 0, "return": [0, 1, 2, 3], "number": [0, 1, 3], "uniqu": 0, "ntype": 0, "depend": [0, 1], "queri": 0, "info": 0, "upstream": 0, "length": [0, 2], "level": [0, 1, 3, 4], "index": [0, 3, 4, 5], "build_feature_graph": 0, "n_neighbor": 0, "15": [0, 3], "metric": [0, 1, 3], "accuraci": 0, "extra": 0, "5": [0, 2, 3], "prob": 0, "metric_kwd": 0, "return_graph": 0, "construct": 0, "k": [0, 3], "knn": 0, "how": 0, "If": 0, "precomput": 0, "distanc": 0, "assum": [0, 3], "known": 0, "we": [0, 1, 4], "re": [0, 4], "almost": 0, "done": 0, "For": 0, "pynndesc": 0, "paramet": [0, 1, 2], "matrix": [0, 1, 3], "squareform": 0, "pdist": 0, "should": [0, 2, 4], "random": [0, 1, 4], "support": 0, "debug": 0, "dict": [0, 1, 3, 4], "field": [0, 2], "option": [0, 1, 2], "conrol": 0, "diversify_prob": 0, "pruning_degree_multpli": 0, "passthrough": 0, "kwd": 0, "sent": 0, "bool": [0, 1], "instead": [0, 4], "updat": 0, "There": 0, "lot": 0, "implemnt": 0, "readthedoc": 0, "check": [0, 3], "build_spatial_graph": 0, "delaunai": 0, "igrah": 0, "triangul": 0, "nx2": 0, "nx3": 0, "around": 0, "centroid": 0, "calc_entropy_at_different_leiden_resolut": 0, "rvec": 0, "logspac": 0, "cond_entropi": 0, "cond": 0, "typevec": 0, "reduc": 0, "merg": 0, "contract": 0, "vertic": 0, "next": 0, "1d": 0, "dtype": [0, 2], "node": [0, 1, 3], "behavior": 0, "assign": 0, "origin": 0, "after": [0, 4], "extract_environ": 0, "ordr": 0, "categor": 0, "distribut": 0, "could": 0, "usag": 0, "local": 0, "neighberhood": 0, "up": [0, 3], "2": [0, 1, 3, 4], "env": 0, "frequenc": 0, "environ": 0, "observ": 0, "underli": 0, "properli": 0, "init": [0, 4], "gradient_magnitud": 0, "gradient": [0, 2], "sqrt": 0, "dv": 0, "dx": 0, "dy": 0, "calcualt": 0, "simpl": [0, 4], "trigo": 0, "graph_local_avg": 0, "vectosmooth": 0, "3": [0, 2], "kernel": 0, "vec": 0, "neighborgood": 0, "want": [0, 1], "smooth": 0, "len": [0, 3], "graph_local_median": 0, "median": [0, 1, 3], "determin": [0, 3], "node_s": 0, "type_freq": 0, "catogor": 0, "probabl": 0, "inputvec": 0, "segment": [0, 2], "first": [0, 1], "peak": 0, "closest": 0, "dijkstra": 0, "tupl": [0, 1], "id": 0, "cloest": 0, "dist": 0, "act": [0, 4], "factori": 0, "storag": [0, 1], "taxnomi": 0, "relat": [0, 4], "full": 0, "feature_type_mat": 0, "etc": [0, 4], "aspect": 0, "vizual": [0, 4], "path": [0, 1], "layers_graph": 0, "relatioship": 0, "induc": 0, "layer_taxonomy_map": 0, "add_geom": 0, "geometri": 0, "boundingbox": 0, "line": 0, "point": [0, 1, 3], "polygon": [0, 3], "view": [0, 4, 5], "add_type_inform": 0, "layer_id": 0, "type_vec": 0, "bookeep": 0, "what": [0, 4], "integ": 0, "intepret": 0, "cosin": [0, 3], "norm": [0, 1, 3], "norm_cel": [0, 3], "true": [0, 1, 2, 3], "norm_basi": [0, 3], "fix": 0, "documentaion": 0, "finish": 0, "path_to_raw_data": 0, "celltypes_org": 0, "expand_typ": 0, "thei": [0, 4], "last": 0, "cell_lay": 0, "isozonelay": 0, "topic": 0, "region_tax": 0, "layor": 0, "scheme": 0, "which": [0, 4], "fill_hol": 0, "lvl_to_fil": 0, "min_node_s": 0, "experiment": 0, "small": 0, "goal": 0, "fill": 0, "hole": 0, "chunk": 0, "unhappi": 0, "As": 0, "6": 0, "8": [0, 3], "2022": 0, "readi": 0, "product": 0, "find_regions_edge_level": 0, "region_lay": 0, "also": [0, 4], "find_upstream_lay": 0, "remov": [0, 2], "hardcod": 0, "alwai": [0, 4], "root": 0, "fangm": [0, 1], "why": 0, "map_to_cell_level": 0, "lvl": [0, 4], "vectomap": 0, "return_ix": 0, "mostli": 0, "plot": [0, 4], "wai": 0, "function": [0, 3], "some": [0, 1], "problem": 0, "json": 0, "everyth": 0, "per": [0, 3], "accord": [0, 3], "theor": 0, "recreat": 0, "servic": 0, "ani": [0, 3, 4], "statist": 0, "appli": 0, "At": 0, "top": 0, "abstract": [0, 4], "interfac": [0, 1], "knnclassifi": [0, 5], "train": [0, 1], "subclass": [0, 4], "addion": 0, "heavi": 0, "lift": 0, "case": [0, 1], "unsuperv": 0, "task": 0, "compos": 0, "heirarchi": 0, "approx_nn": 0, "30": 0, "correl": [0, 3], "nearest": 0, "consid": 0, "nn": [0, 1], "approxim": 0, "row": [0, 3], "approx": 0, "ref_data": 0, "ref_label_id": 0, "knowncelltypeclassifi": [0, 5], "tax_nam": 0, "known_celltyp": 0, "ref": 0, "allen_smrt_dpnmf": 0, "ref_level": 0, "class_label": 0, "neighborhood_label": 0, "subclass_label": 0, "cluster_label": 0, "model": [0, 3, 5], "run_func": [0, 3], "run": [0, 2, 3], "run_kwargs_perlevel": [0, 3], "per_bit_equalscal": [0, 3], "ranknorm": [0, 3], "n_cell": [0, 3], "100": [0, 3], "verbos": [0, 2, 3], "ignore_internal_failur": [0, 3], "optimalleidenknnclassifi": [0, 5], "classifii": 0, "leiden": [0, 3, 5], "learn": [0, 1], "later": 0, "overlad": 0, "doe": [0, 3], "befor": 0, "super": 0, "opt_r": 0, "opt_param": 0, "iter": [0, 1, 2, 3], "10": [0, 1, 3], "n_consensu": 0, "50": [0, 4], "perform": [0, 1], "optim": 0, "cluster": [0, 3], "over": [0, 1, 3], "resolut": [0, 3], "try": 0, "maxim": 0, "h": 0, "few": [0, 1, 4], "control": [0, 3], "optimizaiton": 0, "repeat": [0, 3], "round": [0, 1], "time": [0, 3], "do": [0, 1, 4], "final": 0, "topicclassifi": [0, 5], "4": [0, 3], "latent": 0, "dirichlet": 0, "alloc": 0, "decis": 0, "fit": [0, 1], "lda": 0, "lda_fit": 0, "n_topic": 0, "cannot": 0, "nest": 0, "insid": 0, "n_topics_list": 0, "geomspac": 0, "astyp": 0, "n_proc": 0, "chose": 0, "highest": 0, "gene": [1, 3], "express": 1, "separ": 1, "output": [1, 3], "indistinguish": 1, "celltypenet": [1, 5], "n_gn": 1, "n_cat": 1, "gsubidx": 1, "cnstrnts_idx": 1, "cnstrnt": 1, "n_rcn_layer": 1, "n_bit": 1, "14": 1, "mxpr": 1, "90000": 1, "drprt": 1, "lmd0": 1, "1e": [1, 3], "lmd1": 1, "lmd2": 1, "lmd3": 1, "scale": [1, 3, 4], "min_sgnl": 1, "max_sgnl": 1, "nois": 1, "neural": [1, 3], "network": [1, 3], "bit": [1, 3], "encod": 1, "probe": [1, 3], "categori": 1, "normal": [1, 3], "factor": 1, "max": 2, "dropout": 1, "proport": 1, "dataload": 1, "test_dataload": 1, "devic": 1, "lr": 1, "n_iter": [1, 3], "disable_tqdm": 1, "libsize_norm": [1, 3, 5], "count": [1, 3], "predict": 1, "sm2": 1, "10x": 1, "specif": [1, 4], "pytorch": 1, "instanc": 1, "rate": 1, "valid": 1, "learning_crv": [], "forward": 1, "rnd": 1, "linear": 1, "transform": 1, "subset": [1, 3], "whether": 1, "fine": 1, "grain": 1, "coars": 1, "emb": 1, "embed": [1, 3], "get_emb": 1, "z": [1, 3], "situ": 1, "measur": 1, "tanh": 1, "essenti": 1, "evalut": 1, "margin": 1, "error": [1, 3], "q": 1, "get_encmat": 1, "get_prj": 1, "intens": [1, 3], "proc_batch": 1, "ftr": 1, "clst": [1, 3], "instnrmsimpl": [1, 5], "10000": 1, "min_po": [], "minimum": 1, "signal": 1, "maximum": 1, "rang": 1, "poisson": 1, "propag": 1, "project": [1, 2, 3], "x1": 1, "l": 1, "logscal": 1, "standard": 1, "lower": 1, "upper": 1, "quartil": 1, "init_weight": [1, 5], "m": [1, 2, 3], "take": [1, 3], "initi": [1, 4], "its": 1, "our": 1, "compon": 1, "were": 1, "combin": 1, "relu": 1, "he": 1, "et": 1, "al": 1, "2015": 1, "train_model": [1, 5], "trn_dataload": 1, "tst_dataload": 1, "res_path": 1, "24": 1, "1000": 1, "100000": 1, "n_epoch": 1, "path_trained_model": 1, "result": [1, 3], "load_allen_data": [1, 5], "datasetkei": 1, "path_zarr": 1, "keyx": 1, "keyi": 1, "l3_code": 1, "keyycat": 1, "l3_cat": 1, "batch_siz": 1, "64": 1, "databas": 1, "smrt": 1, "greendata": 1, "generalstorag": 1, "rna": 1, "scrna_ss_ctxhippo_a_exon_count_matrix_v4": 1, "zarr": 1, "smrt_pshopcnst": 1, "cnstrnts_pshop_mm10_isoflat": 1, "pt": [1, 2], "smrt_pshopcnst_geneidx": 1, "gidx_cnstrnts_pshop_mm10_isoflat": 1, "smrt_sub140_geneidx": 1, "gidx_sub140_smrt_v1": 1, "smrt_trn": 1, "scrna_ss_ctxhippo_a_exon_count_matrix_v4_train": 1, "smrt_tst": 1, "scrna_ss_ctxhippo_a_exon_count_matrix_v4_test": 1, "tenx": 1, "scrna_10x_ctxhippo_a_exon_count_matrix_v2": 1, "tenx_trn": 1, "scrna_10x_ctxhippo_a_exon_count_matrix_v2_train": 1, "tenx_trn_v3": 1, "scrna_10x_ctxhippo_a_count_matrix_v3_train": 1, "tenx_tst": 1, "scrna_10x_ctxhippo_a_exon_count_matrix_v2_test": 1, "tenx_tst_v3": 1, "scrna_10x_ctxhippo_a_count_matrix_v3_test": 1, "tenx_v3": 1, "scrna_10x_ctxhippo_a_count_matrix_v3": 1, "scrnaseqdataset": [1, 5], "zarr_fil": 1, "scrna": 1, "seq": 1, "format": [1, 3], "tinydata": 1, "noth": 1, "otherwis": 1, "restrict": 1, "access": 1, "colorize_segmented_imag": [2, 5], "img": 2, "color_typ": 2, "rgb": 2, "randomli": [2, 4], "color": [2, 4], "imag": 2, "displai": 2, "purpos": 2, "param": 2, "np": [2, 3], "2d": [2, 3], "shape": 2, "rg": 2, "red": [2, 4], "green": [2, 4], "rb": 2, "blue": [2, 4], "bg": 2, "generate_ff": [2, 5], "image_metadata": 2, "acq": 2, "channel": 2, "generate_img": [2, 5], "ff": 2, "generate_stitch": [2, 5], "pixel_s": 2, "495": 2, "n_pixel": 2, "exposur": 2, "rotat": 2, "flipud": 2, "fliplr": 2, "torch": [1, 2], "int32": 2, "posnam": 2, "section_class": [2, 5], "metadata_path": 2, "cword_config": 2, "filter_data": 2, "model_typ": 2, "nuclei": 2, "like": [2, 3], "_description_": [1, 2], "find_acq": 2, "hybe": 2, "protocol": 2, "generate_fnam": 2, "generate_iter": 2, "messag": 2, "load_metadata": 2, "load_data": 2, "previous": 2, "load_tensor": 2, "fname": 2, "pull_vector": 2, "save_data": 2, "save_imag": 2, "save_tensor": 2, "tensor": [1, 2], "figur": [2, 4], "out": 2, "gpu": 2, "FOR": 2, "speed": [2, 3], "stitch": 2, "stitcher": 2, "bkg_acq": 2, "update_us": 2, "send": 2, "flat": 2, "correct": 2, "uneven": 2, "illumin": 2, "loader": 2, "acquisit": 2, "preprocess_imag": [2, 5], "nuc_ff": 2, "process_img": [2, 5], "visualize_merg": [2, 5], "img1": 2, "img2": 2, "color1": 2, "color2": 2, "figsiz": [2, 3, 4], "20": [2, 3], "pvmin": 2, "pvmax": 2, "95": [2, 3], "titl": [2, 3], "clip_by_percentil": [3, 5], "low_p": 3, "high_p": 3, "corr_paired_rows_fast": [3, 5], "offset": 3, "mode": 3, "pearsonr": 3, "low": 3, "memori": 3, "compar": 3, "fast2": 3, "corr_paired_rows_fast2": [3, 5], "nan_to_num": 3, "diag_matrix": [3, 5], "col": 3, "threshold": [1, 3], "diagon": 3, "much": 3, "possibl": 3, "diagnal": 3, "smaller": 3, "encourg": 3, "more": 3, "strict": 3, "discourag": 3, "less": 3, "free": 3, "column": 3, "quasi": 3, "diag_matrix_col": [3, 5], "diag_matrix_row": [3, 5], "rearrang": 3, "encode_mat": [3, 5], "d": 3, "entrys": 3, "element": [3, 4], "get_index_from_arrai": [3, 5], "arr": 3, "inq": 3, "na_rep": 3, "group_mean": [3, 5], "mat": 3, "group": 3, "group_ord": 3, "clip_groups": 3, "infer": 3, "group_sum": [3, 5], "advantag": 3, "my": 3, "metacel": 3, "analysi": [3, 5], "script": 3, "well": 3, "librari": 3, "spars": 3, "keep": 3, "normalize_fishdata": [3, 5], "allow_nan": 3, "basi": [1, 3], "clip": 3, "normalize_fishdata_logrowmedian": [3, 5], "rank": [3, 5], "kwarg": [3, 4], "equival": 3, "argsort": 3, "twice": 3, "rank_arrai": [3, 5], "rank_row": [3, 5], "rwo": 3, "reset_log": [3, 5], "reset": 3, "log": 3, "sparse_libsize_norm": [3, 5], "spearman_corrcoef": [3, 5], "spearman": 3, "pair": 3, "spearmanr_paired_row": [3, 5], "p": [3, 4], "slow": 3, "stratified_sampl": [3, 5], "df": 3, "union": 3, "return_idx": 3, "group_kei": 3, "sort": 3, "random_st": 3, "sampl": 3, "oversampl": 3, "stratified_sample_withrep": [3, 5], "replac": 3, "swap_mask": [3, 5], "lookup_o2n": 3, "old": 3, "mask": 3, "swap": 3, "lookup": 3, "tabl": 3, "pd": 3, "seri": 3, "lbl": 3, "unq": 3, "newmat": 3, "zscore": [3, 5], "ignore_zero": 3, "zero_threshold": 3, "dimension": 3, "argument": 3, "mean": 3, "std": 3, "axi": 3, "celltypeclassifi": [3, 5], "x_refdata": 3, "y_refdata": 3, "x_data": 3, "backup": 3, "buildmodel": 3, "classbal": 3, "balanc": 3, "select": 3, "without": 3, "normalizedata": 3, "per_bit": 3, "predictlabel": 3, "run_bag": 3, "n_estim": 3, "algorithm": 3, "sever": 3, "run_iterative_prior": 3, "overall_sample_fract": 3, "min_total_cel": 3, "min_cel": 3, "p0": 3, "subrun_func": 3, "fraction": 3, "run_iterative_prior_v2": 3, "min_cells_pertyp": 3, "max_ratio": 3, "baselin": 3, "trainmodel": 3, "iterative_classifi": [3, 5], "convieni": 3, "evalu": 3, "design": [3, 5], "get_mse_torch": [3, 5], "tnsr_true": 3, "tnsr_pred": 3, "squar": 3, "pred": 3, "varianc": 3, "get_r2_torch": [3, 5], "zero_tol": 3, "plot_dcdx": [3, 5], "prjx_clst": 3, "title1": 3, "decod": 3, "rownam": 3, "colnam": 3, "_row": 3, "_col": 3, "z_norm": 3, "plot_embx_clst": [3, 5], "embx_clst": 3, "embx_clsts_z": 3, "log10": 3, "title2": 3, "title3": 3, "bitwis": 3, "12": 3, "plot_embx_clsts_v2": [3, 5], "dcdx": 3, "title4": 3, "16": 3, "plot_enc": [3, 5], "pmat": 3, "plot_heatcorr": [3, 5], "embx_clsts_corr": 3, "vmin": 3, "vmax": 3, "ax": 3, "cbar_ax": 3, "cmap": 3, "rocket_r": 3, "metric_label": 3, "pearson": 3, "corr": 3, "plot_intn": [3, 5], "prjx": 3, "build_feature_graph_knnlit": [3, 5], "ftrs_mat": 3, "is_in_polygon": [3, 5], "poli": 3, "test": 3, "seed": 3, "whatev": [3, 4], "order_by_hc": [3, 5], "give": 3, "hierar": 3, "panel": [4, 5], "connect": 4, "stuff": 4, "graphic": 4, "overload": 4, "set_view": 4, "here": 4, "actual": 4, "import": 4, "pointer": 4, "belog": 4, "link": 4, "style": 4, "__init__": 4, "dedic": 4, "umap": 4, "historgram": 4, "loglogplot": [4, 5], "you": 4, "think": 4, "colorpleth": [4, 5], "values_to_map": 4, "po": 4, "show": 4, "geo": 4, "request": 4, "iso": 4, "heterozon": 4, "It": 4, "guess": 4, "signatur": 4, "histogram": [4, 5], "values_to_count": 4, "hist": 4, "n_bin": 4, "happen": 4, "sinc": 4, "pass": 4, "legendwithcircl": [4, 5], "map_panel": 4, "300": 4, "count_typ": 4, "legendwithcirclesandwedg": [4, 5], "cell_map_panel": 4, "loglog": 4, "extend": 4, "plot_point": 4, "plot_lin": 4, "plot_bounding_box": 4, "plot_poli": 4, "plot_map": 4, "plot_boundingbox": 4, "randomcolorpleth": [4, 5], "id_vec": 4, "typemap": [4, 5], "cmap_list": 4, "purpl": 4, "orang": 4, "cividi": 4, "typemapwithlin": [4, 5], "11": 4, "add_panel": 4, "zoom": [4, 5], "panel_to_zoom": 4, "zoom_coord": 4, "process": 5, "execut": 5, "putil": 5, "qc": 5, "overview": 5, "tissuegraph": 5, "classif": 5, "visual": 5, "viz": 5, "model_v3p0_bas": 5, "data_load": 5, "data_loader_scrna": 5, "data_fil": 5, "util": 5, "basicu": 5, "celltypeu": 5, "designu": 5, "miscu": 5, "search": 5, "page": 5, "float": 1, "1e4": 1, "1e3": [], "9e4": 1, "_summary_": 1, "turn": 1, "_type_": 1, "diff": 1}, "objects": {"Analysis": [[0, 0, 0, "-", "Classification"], [0, 0, 0, "-", "TissueGraph"]], "Analysis.Classification": [[0, 1, 1, "", "Classifier"], [0, 1, 1, "", "KNNClassifier"], [0, 1, 1, "", "KnownCellTypeClassifier"], [0, 1, 1, "", "OptimalLeidenKNNClassifier"], [0, 1, 1, "", "TopicClassifier"]], "Analysis.Classification.Classifier": [[0, 2, 1, "", "classify"], [0, 3, 1, "", "tax"], [0, 2, 1, "", "train"]], "Analysis.Classification.KNNClassifier": [[0, 3, 1, "", "approx_nn"], [0, 2, 1, "", "classify"], [0, 3, 1, "", "k"], [0, 3, 1, "", "metric"], [0, 2, 1, "", "train"]], "Analysis.Classification.KnownCellTypeClassifier": [[0, 2, 1, "", "classify"], [0, 2, 1, "", "train"]], "Analysis.Classification.OptimalLeidenKNNClassifier": [[0, 2, 1, "", "classify"], [0, 2, 1, "", "train"]], "Analysis.Classification.TopicClassifier": [[0, 2, 1, "", "classify"], [0, 2, 1, "", "lda_fit"], [0, 2, 1, "", "train"]], "Analysis.TissueGraph": [[0, 1, 1, "", "Taxonomy"], [0, 1, 1, "", "TissueGraph"], [0, 1, 1, "", "TissueMultiGraph"]], "Analysis.TissueGraph.Taxonomy": [[0, 4, 1, "", "Type"], [0, 2, 1, "", "add_types"], [0, 4, 1, "", "feature_mat"], [0, 2, 1, "", "is_empty"], [0, 2, 1, "", "load"], [0, 3, 1, "", "name"], [0, 2, 1, "", "save"]], "Analysis.TissueGraph.TissueGraph": [[0, 3, 1, "", "FG"], [0, 4, 1, "", "N"], [0, 4, 1, "", "Nslices"], [0, 4, 1, "", "Ntypes"], [0, 3, 1, "", "SG"], [0, 4, 1, "", "Slice"], [0, 4, 1, "", "Type"], [0, 4, 1, "", "Upstream"], [0, 4, 1, "", "X"], [0, 4, 1, "", "XY"], [0, 4, 1, "", "Y"], [0, 2, 1, "", "build_feature_graph"], [0, 2, 1, "", "build_spatial_graph"], [0, 2, 1, "", "calc_entropy_at_different_Leiden_resolutions"], [0, 2, 1, "", "cond_entropy"], [0, 2, 1, "", "contract_graph"], [0, 2, 1, "", "extract_environments"], [0, 4, 1, "", "feature_mat"], [0, 2, 1, "", "gradient_magnitude"], [0, 2, 1, "", "graph_local_avg"], [0, 2, 1, "", "graph_local_median"], [0, 2, 1, "", "is_empty"], [0, 4, 1, "", "names"], [0, 4, 1, "", "node_size"], [0, 2, 1, "", "save"], [0, 3, 1, "", "tax"], [0, 2, 1, "", "type_freq"], [0, 2, 1, "", "watershed"]], "Analysis.TissueGraph.TissueMultiGraph": [[0, 3, 1, "", "Geoms"], [0, 3, 1, "", "Layers"], [0, 4, 1, "", "N"], [0, 4, 1, "", "Ntypes"], [0, 3, 1, "", "Taxonomies"], [0, 2, 1, "", "add_geoms"], [0, 2, 1, "", "add_type_information"], [0, 3, 1, "", "basepath"], [0, 2, 1, "", "create_cell_layer"], [0, 2, 1, "", "create_isozone_layer"], [0, 2, 1, "", "create_region_layer"], [0, 2, 1, "", "fill_holes"], [0, 2, 1, "", "find_regions_edge_level"], [0, 2, 1, "", "find_upstream_layer"], [0, 3, 1, "", "layer_taxonomy_mapping"], [0, 3, 1, "", "layers_graph"], [0, 2, 1, "", "map_to_cell_level"], [0, 2, 1, "", "save"]], "Design.data_loaders": [[1, 0, 0, "-", "data_files"], [1, 0, 0, "-", "data_loader_scrna"]], "Design.data_loaders.data_loader_scrna": [[1, 5, 1, "", "load_Allen_data"], [1, 1, 1, "", "scRNAseqDataset"]], "Design.models": [[1, 0, 0, "-", "model_v3p0_basic"]], "Design.models.model_v3p0_basic": [[1, 1, 1, "", "CellTypeNet"], [1, 1, 1, "", "InstNrmSimple"], [1, 5, 1, "", "init_weights"], [1, 5, 1, "", "train_model"]], "Design.models.model_v3p0_basic.CellTypeNet": [[1, 2, 1, "", "fit"], [1, 2, 1, "", "forward"], [1, 2, 1, "", "get_emb"], [1, 2, 1, "", "get_encmat"], [1, 2, 1, "", "get_prj"], [1, 2, 1, "", "proc_batch"], [1, 3, 1, "", "training"]], "Design.models.model_v3p0_basic.InstNrmSimple": [[1, 2, 1, "", "forward"], [1, 3, 1, "", "training"]], "Processing": [[2, 0, 0, "-", "QC"], [2, 0, 0, "-", "Section"], [2, 0, 0, "-", "execute"], [2, 0, 0, "-", "putils"]], "Processing.Section": [[2, 1, 1, "", "Section_Class"], [2, 5, 1, "", "generate_FF"], [2, 5, 1, "", "generate_FFs"], [2, 5, 1, "", "preprocess_images"], [2, 5, 1, "", "process_img"], [2, 5, 1, "", "visualize_merge"]], "Processing.Section.Section_Class": [[2, 2, 1, "", "filter_data"], [2, 2, 1, "", "find_acq"], [2, 2, 1, "", "generate_fname"], [2, 2, 1, "", "generate_iterable"], [2, 2, 1, "", "load_metadata"], [2, 2, 1, "", "load_tensor"], [2, 2, 1, "", "pull_vectors"], [2, 2, 1, "", "run"], [2, 2, 1, "", "save_data"], [2, 2, 1, "", "save_image"], [2, 2, 1, "", "save_tensor"], [2, 2, 1, "", "segment"], [2, 2, 1, "", "stitch"], [2, 2, 1, "", "stitcher"], [2, 2, 1, "", "update_user"]], "Processing.putils": [[2, 5, 1, "", "colorize_segmented_image"], [2, 5, 1, "", "generate_FF"], [2, 5, 1, "", "generate_img"], [2, 5, 1, "", "generate_stitched"]], "Utils": [[3, 0, 0, "-", "basicu"], [3, 0, 0, "-", "celltypeu"], [3, 0, 0, "-", "designu"], [3, 0, 0, "-", "miscu"]], "Utils.basicu": [[3, 5, 1, "", "clip_by_percentile"], [3, 5, 1, "", "corr_paired_rows_fast"], [3, 5, 1, "", "corr_paired_rows_fast2"], [3, 5, 1, "", "diag_matrix"], [3, 5, 1, "", "diag_matrix_cols"], [3, 5, 1, "", "diag_matrix_rows"], [3, 5, 1, "", "encode_mat"], [3, 5, 1, "", "get_index_from_array"], [3, 5, 1, "", "group_mean"], [3, 5, 1, "", "group_sum"], [3, 5, 1, "", "libsize_norm"], [3, 5, 1, "", "normalize_fishdata"], [3, 5, 1, "", "normalize_fishdata_logrowmedian"], [3, 5, 1, "", "rank"], [3, 5, 1, "", "rank_array"], [3, 5, 1, "", "rank_rows"], [3, 5, 1, "", "reset_logging"], [3, 5, 1, "", "sparse_libsize_norm"], [3, 5, 1, "", "spearman_corrcoef"], [3, 5, 1, "", "spearmanr_paired_rows"], [3, 5, 1, "", "stratified_sample"], [3, 5, 1, "", "stratified_sample_withrep"], [3, 5, 1, "", "swap_mask"], [3, 5, 1, "", "zscore"]], "Utils.celltypeu": [[3, 1, 1, "", "CellTypeClassify"], [3, 5, 1, "", "iterative_classify"]], "Utils.celltypeu.CellTypeClassify": [[3, 2, 1, "", "backup"], [3, 2, 1, "", "buildModel"], [3, 2, 1, "", "classBalance"], [3, 2, 1, "", "normalizeData"], [3, 2, 1, "", "predictLabels"], [3, 2, 1, "", "rankNorm"], [3, 2, 1, "", "reset"], [3, 2, 1, "", "run"], [3, 2, 1, "", "run_bagging"], [3, 2, 1, "", "run_iterative_prior"], [3, 2, 1, "", "run_iterative_prior_v2"], [3, 2, 1, "", "trainModel"]], "Utils.designu": [[3, 5, 1, "", "get_mse_torch"], [3, 5, 1, "", "get_r2_torch"], [3, 5, 1, "", "plot_dcdx"], [3, 5, 1, "", "plot_embx_clsts"], [3, 5, 1, "", "plot_embx_clsts_v2"], [3, 5, 1, "", "plot_enc"], [3, 5, 1, "", "plot_heatcorr"], [3, 5, 1, "", "plot_intn"]], "Utils.miscu": [[3, 5, 1, "", "build_feature_graph_knnlite"], [3, 5, 1, "", "is_in_polygon"], [3, 5, 1, "", "leiden"], [3, 5, 1, "", "order_by_hc"]], "Visualization": [[4, 0, 0, "-", "Viz"]], "Visualization.Viz": [[4, 1, 1, "", "Colorpleth"], [4, 1, 1, "", "Histogram"], [4, 1, 1, "", "IsoZones"], [4, 1, 1, "", "LegendWithCircles"], [4, 1, 1, "", "LegendWithCirclesAndWedges"], [4, 1, 1, "", "LogLogPlot"], [4, 1, 1, "", "Map"], [4, 1, 1, "", "Panel"], [4, 1, 1, "", "RandomColorpleth"], [4, 1, 1, "", "TypeMap"], [4, 1, 1, "", "TypeMapWithLines"], [4, 1, 1, "", "View"], [4, 1, 1, "", "Zoom"]], "Visualization.Viz.Colorpleth": [[4, 2, 1, "", "set_view"]], "Visualization.Viz.Histogram": [[4, 2, 1, "", "plot"], [4, 2, 1, "", "set_view"]], "Visualization.Viz.IsoZones": [[4, 2, 1, "", "set_view"]], "Visualization.Viz.LegendWithCircles": [[4, 2, 1, "", "plot"], [4, 2, 1, "", "set_view"]], "Visualization.Viz.LegendWithCirclesAndWedges": [[4, 2, 1, "", "plot"]], "Visualization.Viz.LogLogPlot": [[4, 2, 1, "", "plot"], [4, 2, 1, "", "set_view"]], "Visualization.Viz.Map": [[4, 2, 1, "", "plot"], [4, 2, 1, "", "plot_boundingbox"], [4, 2, 1, "", "plot_lines"], [4, 2, 1, "", "plot_points"], [4, 2, 1, "", "plot_polys"], [4, 2, 1, "", "set_view"]], "Visualization.Viz.Panel": [[4, 2, 1, "", "plot"], [4, 2, 1, "", "set_view"]], "Visualization.Viz.RandomColorpleth": [[4, 2, 1, "", "set_view"]], "Visualization.Viz.TypeMap": [[4, 2, 1, "", "set_view"]], "Visualization.Viz.TypeMapWithLines": [[4, 2, 1, "", "plot"], [4, 2, 1, "", "set_view"]], "Visualization.Viz.View": [[4, 2, 1, "", "add_panel"], [4, 2, 1, "", "show"]], "Visualization.Viz.Zoom": [[4, 2, 1, "", "plot"], [4, 2, 1, "", "set_view"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:property", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "property", "Python property"], "5": ["py", "function", "Python function"]}, "titleterms": {"analysi": 0, "overview": 0, "tissuegraph": 0, "exampl": 0, "classif": 0, "design": 1, "model": 1, "model_v3p0_bas": 1, "data_load": 1, "data_loader_scrna": 1, "data_fil": 1, "process": 2, "execut": 2, "putil": 2, "qc": 2, "section": 2, "util": 3, "basicu": 3, "celltypeu": 3, "designu": 3, "miscu": 3, "visual": 4, "viz": 4, "welcom": 5, "dredfish": 5, "": 5, "document": 5, "content": 5, "indic": 5, "tabl": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.todo": 2, "sphinx": 57}, "alltitles": {"Analysis": [[0, "analysis"]], "Overview": [[0, "overview"]], "Analysis.TissueGraph": [[0, "analysis-tissuegraph"]], "Example": [[0, null]], "Analysis.Classification": [[0, "analysis-classification"]], "Processing": [[2, "processing"]], "Processing.execute": [[2, "module-Processing.execute"]], "Processing.putils": [[2, "module-Processing.putils"]], "Processing.QC": [[2, "module-Processing.QC"]], "Processing.Section": [[2, "module-Processing.Section"]], "Utils": [[3, "utils"]], "Utils.basicu": [[3, "module-Utils.basicu"]], "Utils.celltypeu": [[3, "module-Utils.celltypeu"]], "Utils.designu": [[3, "module-Utils.designu"]], "Utils.miscu": [[3, "module-Utils.miscu"]], "Visualization": [[4, "visualization"]], "Visualization.Viz": [[4, "module-Visualization.Viz"]], "Welcome to dredFISH\u2019s documentation!": [[5, "welcome-to-dredfish-s-documentation"]], "Contents:": [[5, null]], "Indices and tables": [[5, "indices-and-tables"]], "Design": [[1, "design"]], "Design.models.model_v3p0_basic": [[1, "module-Design.models.model_v3p0_basic"]], "Design.data_loaders.data_loader_scrna": [[1, "module-Design.data_loaders.data_loader_scrna"]], "Design.data_loaders.data_files": [[1, "module-Design.data_loaders.data_files"]]}, "indexentries": {"celltypenet (class in design.models.model_v3p0_basic)": [[1, "Design.models.model_v3p0_basic.CellTypeNet"]], "design.data_loaders.data_files": [[1, "module-Design.data_loaders.data_files"]], "design.data_loaders.data_loader_scrna": [[1, "module-Design.data_loaders.data_loader_scrna"]], "design.models.model_v3p0_basic": [[1, "module-Design.models.model_v3p0_basic"]], "instnrmsimple (class in design.models.model_v3p0_basic)": [[1, "Design.models.model_v3p0_basic.InstNrmSimple"]], "fit() (design.models.model_v3p0_basic.celltypenet method)": [[1, "Design.models.model_v3p0_basic.CellTypeNet.fit"]], "forward() (design.models.model_v3p0_basic.celltypenet method)": [[1, "Design.models.model_v3p0_basic.CellTypeNet.forward"]], "forward() (design.models.model_v3p0_basic.instnrmsimple method)": [[1, "Design.models.model_v3p0_basic.InstNrmSimple.forward"]], "get_emb() (design.models.model_v3p0_basic.celltypenet method)": [[1, "Design.models.model_v3p0_basic.CellTypeNet.get_emb"]], "get_encmat() (design.models.model_v3p0_basic.celltypenet method)": [[1, "Design.models.model_v3p0_basic.CellTypeNet.get_encmat"]], "get_prj() (design.models.model_v3p0_basic.celltypenet method)": [[1, "Design.models.model_v3p0_basic.CellTypeNet.get_prj"]], "init_weights() (in module design.models.model_v3p0_basic)": [[1, "Design.models.model_v3p0_basic.init_weights"]], "load_allen_data() (in module design.data_loaders.data_loader_scrna)": [[1, "Design.data_loaders.data_loader_scrna.load_Allen_data"]], "module": [[1, "module-Design.data_loaders.data_files"], [1, "module-Design.data_loaders.data_loader_scrna"], [1, "module-Design.models.model_v3p0_basic"]], "proc_batch() (design.models.model_v3p0_basic.celltypenet method)": [[1, "Design.models.model_v3p0_basic.CellTypeNet.proc_batch"]], "scrnaseqdataset (class in design.data_loaders.data_loader_scrna)": [[1, "Design.data_loaders.data_loader_scrna.scRNAseqDataset"]], "train_model() (in module design.models.model_v3p0_basic)": [[1, "Design.models.model_v3p0_basic.train_model"]], "training (design.models.model_v3p0_basic.celltypenet attribute)": [[1, "Design.models.model_v3p0_basic.CellTypeNet.training"]], "training (design.models.model_v3p0_basic.instnrmsimple attribute)": [[1, "Design.models.model_v3p0_basic.InstNrmSimple.training"]]}})